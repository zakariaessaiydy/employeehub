<div class="animate-fade-in">
  <div class="text-center mb-8">
    <h2 class="text-3xl font-bold text-gray-900 dark:text-white flex items-center justify-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-secondary" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" /></svg>
      <span>Rewards Shop</span>
    </h2>
    <p class="text-gray-500 dark:text-gray-400 mt-2">Use your hard-earned kudos points to claim awesome rewards!</p>
    @if(currentUser(); as user) {
        <p class="mt-4 text-xl font-semibold flex items-center justify-center">Your Points Balance: 
          <span class="text-secondary ml-2 flex items-center">
            {{ user.kudosReceived }} 
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" /></svg>
          </span>
        </p>
    }
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
    @for (reward of rewards(); track reward.id) {
      @let canAfford = currentUser()!.kudosReceived >= reward.cost;
      <div class="bg-white dark:bg-base-200 rounded-lg shadow-lg overflow-hidden flex flex-col justify-between animate-slide-in-up">
        <img [src]="reward.imageUrl" alt="{{reward.name}}" class="w-full h-48 object-cover">
        <div class="p-5 flex-grow">
          <h4 class="text-lg font-bold text-gray-900 dark:text-white">{{ reward.name }}</h4>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1 mb-3">{{ reward.description }}</p>
        </div>
        <div class="px-5 pb-5">
           <div class="text-xl font-bold text-secondary mb-4 flex items-center">
            {{ reward.cost }} 
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" /></svg>
          </div>
           <button 
            (click)="onRedeem(reward)"
            [disabled]="!canAfford"
            class="w-full py-2 rounded-lg font-semibold transition-colors"
            [class]="canAfford ? 'bg-secondary text-white hover:bg-pink-600' : 'bg-gray-400 dark:bg-gray-600 text-gray-200 dark:text-gray-400 cursor-not-allowed'">
            {{ canAfford ? 'Redeem' : 'Not Enough Points' }}
          </button>
        </div>
      </div>
    }
  </div>
</div>